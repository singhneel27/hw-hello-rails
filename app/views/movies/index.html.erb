<% content_for :title, "Movies" %>

<h1>Movies</h1>

<p style="color: green"><%= notice %></p>

<div id="movies">
  <table>
    <thead>
      <tr>
        <th class="sortable <%= 'asc-sort' if params[:sort] == 'by_title' && params[:direction] == 'asc' %>
                  <%= 'desc-sort' if params[:sort] == 'by_title' && params[:direction] == 'desc' %>">
          <%= link_to "Title", movies_path(sort: :by_title, direction: (params[:sort] == 'by_title' && params[:direction] == 'asc' ? 'desc' : 'asc')), class: 'header' %>
          <span class='icon'>
            <% if params[:sort] == 'by_title' %>
              <% if params[:direction] == 'asc' %>
                <%= image_tag('asc.svg', size: '18x18') %>
              <% else %>
                <%= image_tag('desc.svg', size: '18x18') %>
              <% end %>
            <% end %>
          </span>
        </th>

        <th class="sortable <%= 'asc-sort' if params[:sort] == 'by_rating' && params[:direction] == 'asc' %>
                  <%= 'desc-sort' if params[:sort] == 'by_rating' && params[:direction] == 'desc' %>">
          <%= link_to "Rating", movies_path(sort: :by_rating, direction: (params[:sort] == 'by_rating' && params[:direction] == 'asc') ? 'desc' : 'asc'), class: 'header' %>
          <span class='icon'>
            <% if params[:sort] == 'by_rating' %>
              <% if params[:direction] == 'asc' %>
                <%= image_tag('asc.svg', size: '18x18') %>
              <% else %>
                <%= image_tag('desc.svg', size: '18x18') %>
              <% end %>
            <% end %>
          </span>
        </th>

        <th class="sortable <%= 'asc-sort' if params[:sort] == 'by_release_date' && params[:direction] == 'asc' %>
                  <%= 'desc-sort' if params[:sort] == 'by_release_date' && params[:direction] == 'desc' %>">
          <%= link_to "Release Date", movies_path(sort: :by_release_date, direction: (params[:sort] == 'by_release_date' && params[:direction] == 'asc') ? 'desc' : 'asc'), class: 'header' %>
          <span class='icon'>
            <% if params[:sort] == 'by_release_date' %>
              <% if params[:direction] == 'asc' %>
                <%= image_tag('asc.svg', size: '18x18') %>
              <% else %>
                <%= image_tag('desc.svg', size: '18x18') %>
              <% end %>
            <% end %>
          </span>
        </th>

        <th class="actions">
          Actions
        </th>
      </tr>
    </thead>

    <tbody>
      <% @movies.each do |movie| %>
        <tr id="<%= dom_id movie %>">
          <td class="<%= 'sort-column' if params[:sort] == 'by_title' %> <%= 'asc-sort' if params[:sort] == 'by_title' && params[:direction] == 'asc' %>
                    <%= 'desc-sort' if params[:sort] == 'by_title' && params[:direction] == 'desc' %>">
            <%= movie.title %>
          </td>

          <td class="<%= 'sort-column' if params[:sort] == 'by_rating' %> <%= 'asc-sort' if params[:sort] == 'by_rating' && params[:direction] == 'asc' %>
                    <%= 'desc-sort' if params[:sort] == 'by_rating' && params[:direction] == 'desc' %>">
            <%= movie.rating %>
          </td>

          <td class="<%= 'sort-column' if params[:sort] == 'by_release_date' %> <%= 'asc-sort' if params[:sort] == 'by_release_date' && params[:direction] == 'asc' %>
                    <%= 'desc-sort' if params[:sort] == 'by_release_date' && params[:direction] == 'desc' %>">
            <%= movie.release_date %>
          </td>

          <td>
            <%= link_to 'Show', movie_path(movie), class: 'show_button' %>
            <%= link_to 'Edit', edit_movie_path(movie), class: 'edit_button' %>
            <%= link_to 'Destroy', movie_path(movie), method: :delete, class: 'delete_button' %>
          </td>
        </tr>
      <% end %>
    </tbody>

    <tfoot>
      <tr>
        <td colspan="4">
          <%= link_to "New movie", new_movie_path, class: 'new_button' %>
        </td>
      </tr>
    </tfoot>
  </table>
</div>
